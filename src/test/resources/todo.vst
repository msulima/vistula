'''# javascript
let submitTasks = new vistula.ObservableImpl();
'''

sample = {
  "title": "Finish TodoMVC",
  "completed": false
}

todos = ([sample] or arrayPush(todos, submitTasks) for todos in submitTasks)

app = '''# html
<form id="task" method="POST">
  <input name="title" placeholder="What needs to be done?"/>
</form>
<div>
  <ul>
    {% for todo in todos %}
      <li>
        {% if todo.completed %}
          âˆš
        {% else %}
          x
        {% endif %}
        {{ todo.title }}
      </li>
    {% endfor %}
  </ul>
</div>
'''

stdlib.dom.appendChild("app", app)

'''# javascript
document.getElementById("task").addEventListener("submit", function (ev) {
  ev.preventDefault();
  let elements = ev.srcElement.elements;
  let formValue = {};
  Object.keys(elements).forEach(function (key) {
    formValue[elements[key].name] = elements[key].value;
  });
  formValue["completed"] = false;

  submitTasks.rxPush(vistula.toObservable(formValue));
});
'''
